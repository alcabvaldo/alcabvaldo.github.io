---
// Layout component - loads all configuration from data files
import { siteConfig, scripts } from '../data/index.js';

export interface Props {
  title?: string;
  description?: string;
}

const { 
  title = siteConfig.title,
  description = siteConfig.description 
} = Astro.props;

// Get SAL.js configuration
const salConfig = scripts.external.find(lib => lib.name === "SAL.js");
---

<!DOCTYPE HTML>
<!--
	Miniport by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html lang={siteConfig.language}>
  <head>
    <title>{title}</title>
    <meta charset={siteConfig.charset} />
    <meta name="viewport" content={siteConfig.viewport} />
    <meta name="description" content={description} />
    <meta name="keywords" content={siteConfig.keywords.join(', ')} />
    <meta name="author" content={siteConfig.author} />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={siteConfig.url} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={siteConfig.url + siteConfig.ogImage} />

    <!-- Twitter -->
    <meta property="twitter:card" content={siteConfig.twitterCard} />
    <meta property="twitter:url" content={siteConfig.url} />
    <meta property="twitter:title" content={title} />
    <meta property="twitter:description" content={description} />
    <meta property="twitter:image" content={siteConfig.url + siteConfig.ogImage} />
    
    <!-- Theme Styles -->
    <style>
      @import '../styles/theme/theme.css';
    </style>
    
    <!-- Critical Text Readability Fixes -->
    <style>
      /* Override HTML5UP light colors for better readability */
      body, html {
        color: #334155 !important; /* Dark gray for better contrast */
        background: #ffffff !important;
      }
      
      /* Ensure all headings are dark and readable */
      h1, h2, h3, h4, h5, h6 {
        color: #0f172a !important; /* Very dark for headings */
        font-weight: 600 !important;
      }
      
      /* Fix paragraph and general text */
      p, div, span, li, td, th {
        color: #475569 !important; /* Medium-dark gray for body text */
      }
      
      /* Navigation text */
      nav a, .nav-link {
        color: #334155 !important;
      }
      
      nav a:hover, .nav-link:hover {
        color: #2563eb !important; /* Primary blue on hover */
      }
      
      /* Button text */
      .button, .btn, button {
        color: #ffffff !important;
      }
      
      /* Card and section text */
      .card, .feature, .project-card {
        color: #475569 !important;
      }
      
      .card h3, .card h4, .feature h3, .feature h4 {
        color: #1e293b !important;
      }
      
      /* Skills and technical content */
      .skill-item, .tech-tag, .category {
        color: #334155 !important;
      }
      
      /* Contact section */
      .contact-section p, .contact-section div {
        color: #475569 !important;
      }
      
      .contact-section h2, .contact-section h3 {
        color: #0f172a !important;
      }
      
      /* Links - ensure they're visible */
      a {
        color: #2563eb !important;
        text-decoration: none;
      }
      
      a:hover {
        color: #1d4ed8 !important;
        text-decoration: underline;
      }
      
      /* Footer text */
      footer, .footer-content {
        color: #64748b !important;
      }
      
      /* Hero section specific fixes */
      .hero-section h1, .hero-title {
        color: #0f172a !important;
      }
      
      .hero-section p, .hero-description {
        color: #475569 !important;
      }
      
      /* About section fixes */
      .about-section p, .summary p {
        color: #475569 !important;
      }
      
      /* Ensure icons are visible */
      i, .icon {
        opacity: 0.8;
      }
      
      /* Override any remaining light colors */
      .wrapper {
        color: #475569 !important;
      }
      
      /* Make sure accent text is readable */
      .gradient-text {
        background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%) !important;
        -webkit-background-clip: text !important;
        -webkit-text-fill-color: transparent !important;
        background-clip: text !important;
        font-weight: 700 !important;
      }
      
      /* Ensure status indicators are visible */
      .status-badge, .badge {
        color: #2563eb !important;
        background: rgba(37, 99, 235, 0.1) !important;
        border: 1px solid rgba(37, 99, 235, 0.2) !important;
      }
      
      /* Fix any remaining problematic light text */
      [style*="color: #888"], 
      [style*="color: #bbb"], 
      [style*="color: #ccc"], 
      [style*="color: #999"] {
        color: #475569 !important;
      }
    </style>
    
    <!-- Stylesheets -->
    {scripts.stylesheets.map(stylesheet => (
      <link rel="stylesheet" href={stylesheet.href} />
    ))}
    
    <link rel="icon" type={siteConfig.faviconType} href={siteConfig.favicon}>
  </head>
  <body class="is-preload">
    <slot />
    
    <!-- Back to Top Button -->
    <button id="back-to-top" class="back-to-top" title="Back to Top">
      <i class="icon solid fa-chevron-up"></i>
    </button>
    
    <!-- Core Scripts -->
    {scripts.core.map(script => (
      <script is:inline src={script.src}></script>
    ))}
    
    <!-- External Libraries -->
    {scripts.external.map(library => (
      <script is:inline src={library.js}></script>
    ))}
    
    <!-- SAL.js Initialization -->
    {salConfig && (
      <script is:inline set:html={salConfig.initCode}></script>
    )}
    
    <!-- Custom Scripts for Enhanced UX -->
    <script is:inline>
      // Back to Top Button Functionality
      window.addEventListener('scroll', function() {
        const backToTopButton = document.getElementById('back-to-top');
        if (window.pageYOffset > 300) {
          backToTopButton.classList.add('show');
        } else {
          backToTopButton.classList.remove('show');
        }
      });

      document.getElementById('back-to-top').addEventListener('click', function() {
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      });

      // Enhanced smooth scrolling for navigation links
      document.addEventListener('DOMContentLoaded', function() {
        const navLinks = document.querySelectorAll('a[href^="#"]');
        navLinks.forEach(link => {
          link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href');
            const targetElement = document.querySelector(targetId);
            if (targetElement) {
              targetElement.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
              });
            }
          });
        });
      });
    </script>

    <style>
      /* Back to Top Button Styles */
      .back-to-top {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 50px;
        height: 50px;
        background: linear-gradient(135deg, #4acaa8 0%, #3db090 100%);
        border: none;
        border-radius: 50%;
        color: white;
        font-size: 18px;
        cursor: pointer;
        opacity: 0;
        visibility: hidden;
        transform: translateY(20px);
        transition: all 0.3s ease;
        z-index: 1000;
        box-shadow: 0 4px 15px rgba(74, 202, 168, 0.4);
      }

      .back-to-top.show {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      .back-to-top:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(74, 202, 168, 0.6);
      }

      /* Enhanced scroll behavior */
      html {
        scroll-behavior: smooth;
      }

      /* Loading animation improvements */
      .is-preload * {
        animation-delay: 0.1s !important;
      }

      /* Global improvements */
      body {
        position: relative;
      }

      /* Enhanced navigation active states */
      #nav a {
        transition: all 0.3s ease;
      }

      #nav a:hover {
        color: #4acaa8 !important;
        transform: translateY(-2px);
      }

      /* Professional scrollbar styling */
      ::-webkit-scrollbar {
        width: 8px;
      }

      ::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
      }

      ::-webkit-scrollbar-thumb {
        background: linear-gradient(135deg, #4acaa8, #3db090);
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(135deg, #3db090, #4acaa8);
      }

      @media screen and (max-width: 736px) {
        .back-to-top {
          bottom: 20px;
          right: 20px;
          width: 45px;
          height: 45px;
          font-size: 16px;
        }
      }
    </style>
  </body>
</html>