---
// Reusable Work Experience Item Component
import Card from '../ui/Card.astro';
import Icon from '../ui/Icon.astro';

export interface Props {
  company: string;
  position: string;
  duration: string;
  location: string;
  type: string;
  status: string;
  description: string;
  responsibilities: string[];
  technologies: string[];
  achievements: string[];
  companyInfo: {
    website?: string;
    industry: string;
    size: string;
    logo?: string;
  };
  'data-sal'?: string;
  'data-sal-delay'?: string | number;
  'data-sal-duration'?: string | number;
}

const { 
  company,
  position,
  duration,
  location,
  type,
  status,
  description,
  responsibilities,
  technologies,
  achievements,
  companyInfo,
  ...props
} = Astro.props;

const typeIcons = {
  'Freelance': 'fa-laptop-code',
  'Education': 'fa-graduation-cap',
  'Personal': 'fa-user',
  'Full-time': 'fa-briefcase',
  'Part-time': 'fa-clock',
  'Contract': 'fa-handshake'
};

const statusColors = {
  'current': 'var(--color-success)',
  'completed': 'var(--color-info)',
  'ongoing': 'var(--color-warning)'
};
---

<Card variant="feature" {...props}>
  <div class="work-header">
    <div class="work-icon">
      {companyInfo.logo ? (
        <div class="company-logo">
          <img src={companyInfo.logo} alt={`${company} logo`} loading="lazy" />
        </div>
      ) : (
        <Icon icon={typeIcons[type] || 'fa-briefcase'} variant="circular" />
      )}
    </div>
    
    <div class="work-meta">
      <h4 class="work-position">{position}</h4>
      <h5 class="work-company">
        {companyInfo.website ? (
          <a href={companyInfo.website} target="_blank" rel="noopener" class="company-link">
            {company}
          </a>
        ) : (
          company
        )}
      </h5>
      
      <div class="work-details">
        <span class="work-duration">
          <i class="icon solid fa-calendar-alt"></i>
          {duration}
        </span>
        <span class="work-location">
          <i class="icon solid fa-map-marker-alt"></i>
          {location}
        </span>
        <span class="work-type">
          <i class="icon solid fa-tag"></i>
          {type}
        </span>
        <span class={`work-status work-status--${status}`}>
          <i class="icon solid fa-circle"></i>
          {status.charAt(0).toUpperCase() + status.slice(1)}
        </span>
      </div>
    </div>
  </div>

  <div class="work-content">
    <p class="work-description">{description}</p>

    <div class="work-section">
      <h6>Key Responsibilities:</h6>
      <ul class="work-list">
        {responsibilities.map(responsibility => (
          <li>{responsibility}</li>
        ))}
      </ul>
    </div>

    <div class="work-section">
      <h6>Technologies Used:</h6>
      <div class="tech-tags">
        {technologies.map(tech => (
          <span class="tech-tag">{tech}</span>
        ))}
      </div>
    </div>

    {achievements.length > 0 && (
      <div class="work-section">
        <h6>Key Achievements:</h6>
        <ul class="achievements-list">
          {achievements.map(achievement => (
            <li>{achievement}</li>
          ))}
        </ul>
      </div>
    )}

    <div class="company-info">
      <span class="company-detail">
        <i class="icon solid fa-industry"></i>
        {companyInfo.industry}
      </span>
      <span class="company-detail">
        <i class="icon solid fa-users"></i>
        {companyInfo.size}
      </span>
    </div>
  </div>
</Card>

<style>
  @import '../../styles/sections/work-experience.css';
</style>